apiVersion: v1
kind: ConfigMap
metadata:
  name: frontend-config
  namespace: petclinic
  labels:
    app: frontend
data:
  application.yml: |
    server:
      port: 8080
      compression:
        enabled: true
        mime-types: application/json,application/xml,text/html,text/xml,text/plain,application/javascript,text/css

    spring:
      application:
        name: frontend
      config:
        import: optional:configserver:${CONFIG_SERVER_URL:http://config-server:8888}
      cloud:
        gateway:
          # フロントエンド専用設定
          # Note: /api/gateway/** routes are now handled directly by Kong (bypassing frontend)
          # Frontend only handles direct /api/* routes (not used in current architecture)
          discovery:
            enabled: false

    eureka:
      client:
        enabled: true
        serviceUrl:
          defaultZone: ${EUREKA_SERVER_URL:http://discovery-server:8761/eureka}
        registryFetchIntervalSeconds: 5
        registerWithEureka: true
        fetchRegistry: true
      instance:
        preferIpAddress: true
        lease-renewal-interval-in-seconds: 5

    management:
      endpoints:
        web:
          exposure:
            include: '*'
      endpoint:
        health:
          show-details: always
      # Disable Spring Boot's built-in tracing (using OpenTelemetry instead)
      tracing:
        enabled: false
      zipkin:
        tracing:
          endpoint: ""  # Disable Zipkin exporter
      
    # Disable Spring Cloud Sleuth Zipkin (OpenTelemetry handles all tracing)
    # This prevents duplicate traces to localhost:9411
    spring.zipkin.enabled: false
    spring.sleuth.enabled: false

    logging:
      level:
        root: INFO
        org.springframework.cloud.gateway: INFO
        org.springframework.web: INFO

